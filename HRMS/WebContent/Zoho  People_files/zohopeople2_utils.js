var _DIALOG_LAYER_VAR="_DIALOG_LAYER";var FreezeLayer_VAR="FreezeLayer";var FreezeIFrame_VAR="FreezeIFrame";var oDialog,doc,srcEl,closeOnEscKey=true,closeOnBodyClick=false,needIframe=true,iframeIEHack;var dialogProperties=new Array("position","top","left","height","width","srcElement","modal","draggable","title","closeButton","closeOnEscKey","transitionType","transitionInterval","closeOnBodyClick","needIframe","closeParent");var oCloseClBk=null;function showDialog(_1,_2,_3,_4){_DIALOG_LAYER_VAR="_DIALOG_LAYER";FreezeLayer_VAR="FreezeLayer";FreezeIFrame_VAR="FreezeIFrame";oCloseClBk=_4;if(typeof (_2)=="undefined"){var _2="position=absmiddle";}_2=_2.split(",");var _5;for(var i=0;i<dialogProperties.length;i++){_5=false;for(var j=0;j<_2.length;j++){if(_2[j].indexOf(dialogProperties[i])>=0){_5=true;break;}}self["dialog_"+dialogProperties[i]]=(_5)?_2[j].substr(_2[j].indexOf("=")+1,_2[j].length).trim():"undefined";}if(dialog_closeParent=="undefined"){dialog_closeParent=true;}var _8=document.getElementById("_DIALOG_LAYER");if(dialog_closeParent=="false"&&_8!=null&&_8.id=="_DIALOG_LAYER"&&_8.style.display!="none"){_DIALOG_LAYER_VAR="_DIALOG_LAYER_CHILD";FreezeLayer_VAR="FreezeLayer_Child";FreezeIFrame_VAR="FreezeIFrame_Child";}oldDialogId=document.getElementById(_DIALOG_LAYER_VAR);if(dialog_closeParent&&oldDialogId!=null&&oldDialogId){oldDialogId.parentNode.removeChild(oldDialogId);}oDialog=document.createElement("DIV");oDialog.id=_DIALOG_LAYER_VAR;document.body.appendChild(oDialog);var _1="<div id=\"_DIALOG_CONTENT\">"+_1+"</div>";var _9="<table class=\"DialogBox\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\"><tr><td class=\"boxTL\">&nbsp;</td>";if(dialog_draggable!="undefined"&&dialog_draggable=="no"){_9+="<td class=\"boxHeader\">";}else{_9+="<td class=\"boxHeader drag\" onMouseDown=\"captureDialog(event)\">";}if(dialog_title!="undefined"){if(dialog_title.charAt(0)=="'"&&dialog_title.charAt(dialog_title.length-1)=="'"){dialog_title=dialog_title.substr(1,dialog_title.length-2);}if(dialog_title.trim().length==0){dialog_title="&nbsp;";}}else{dialog_title="&nbsp;";}_9+=dialog_title+"</td><td class=\"boxCtrlButtonPane\">";if(dialog_closeButton!="undefined"&&dialog_closeButton=="no"){_9+="&nbsp;</td>";}else{_9+="<input type=\"button\" class=\"closeButton\" onClick=\"closeDialog()\"></td>";}_9+="<td class=\"boxTR\">&nbsp;</td></tr><tr><td colspan=\"4\" class=\"boxContent\">"+_1+"</td></tr>";_9+="<tr><td class=\"boxBL\"></td><td class=\"boxBC\" colspan=\"2\"></td><td class=\"boxBR\"></td></tr></table>";oDialog.style.display="block";var _a=true;if(dialog_closeButton!="undefined"){if(dialog_title=="&nbsp;"&&dialog_closeButton=="no"){_a=false;}}if(_a){oDialog.innerHTML="<table cellpadding='0' cellspacing='0' class='dialog-border'><tr><td height='100%' style='display:block'>"+_9+"</td></tr></table>";}else{oDialog.innerHTML="<table cellpadding='0' cellspacing='0' class=''><tr><td height='100%' style='display:block'>"+_1+"</td></tr></table>";}oDialog.style.position="absolute";oDialog.style.left="-1000px";oDialog.style.top="-1000px";oDialog.style.zIndex="9999";if(oDialog.id=="_DIALOG_LAYER_CHILD"){oDialog.style.zIndex="102";}if(dialog_position!="relative"){var _b=150;var _c=350;var _d=document.body.clientHeight;var _e=document.body.clientWidth;var _f=oDialog.offsetWidth;var _10=oDialog.offsetHeight;if(oDialog.id=="_DIALOG_LAYER_CHILD"){_e=document.getElementById("_DIALOG_LAYER").offsetWidth;_d=document.getElementById("_DIALOG_LAYER").offsetHeight;}if((_d-_10)>0){if(((_d-_10)/2)<150){_b=(_d-_10)/2;}}else{if((_d-_10)<=0){_b=0;}}if((_e-_f)>0){if(((_e-_f)/2)<350){_c=(_e-_f)/2;}}else{if((_e-_f)<=0){_c=0;}}if(oDialog.id=="_DIALOG_LAYER_CHILD"){var _11=document.getElementById("_DIALOG_LAYER").style.left;_11=_11.substring(0,_11.indexOf("px"));var top=document.getElementById("_DIALOG_LAYER").style.top;top=top.substring(0,top.indexOf("px"));_c=_c+parseInt(_11);_b=_b+parseInt(top);}dialog_left=_c;dialog_top=_b;}if(browser_opera){var _13=_1;var _14=oDialog.getElementsByTagName("STYLE");for(var i=0;i<_14.length;i++){_14[i].innerHTML=_13.substring(_13.indexOf("<style>")+7,_13.indexOf("</style>")-1);_13=_13.substring(_13.indexOf("</style>")+8,_13.length);}}if(dialog_width!="undefined"){if(browser_ie){oDialog.childNodes[0].style.width=parseInt(dialog_width)+"px";}else{if(browser_nn4||browser_nn6){oDialog.childNodes.item(0).style.width=parseInt(dialog_width)+"px";}}}if(dialog_height!="undefined"){if(browser_ie){oDialog.childNodes[0].style.height=parseInt(dialog_height)+"px";}else{if(browser_nn4||browser_nn6){oDialog.childNodes.item(0).style.height=parseInt(dialog_height)+"px";}}}oDialogContent=getObj("_DIALOG_CONTENT");var _11=0,top=0;if(browser_opera){if(dialog_width!="undefined"){oDialogContent.style.width=parseInt(dialog_width)+"px";}else{Content.style.width=oDialogContent.offsetWidth+"px";oDialog.style.width=oDialogContent.offsetWidth+"px";}}if(browser_nn4||browser_nn6){if(!browser_chrome){oDialogContent.style.width="100%";}if(dialog_width!="undefined"){oDialogContent.style.width=parseInt(dialog_width)+"px";}else{var _15=$(window).width()-100;if(_15>oDialogContent.offsetWidth){_15=oDialogContent.offsetWidth+20;}oDialogContent.style.width=(_15)+"px";}}if(dialog_height!="undefined"){if(browser_ie&&(parseInt(dialog_height)<oDialogContent.offsetHeight)){_11=-15;}oDialogContent.style.height=parseInt(dialog_height)+"px";}var _16=oDialog.offsetWidth;var _17=oDialog.offsetHeight;doc=findDocDim();if(dialog_closeOnEscKey!="undefined"&&dialog_closeOnEscKey=="no"){closeOnEscKey=false;}else{closeOnEscKey=true;}if(dialog_closeOnBodyClick!="undefined"&&dialog_closeOnBodyClick=="yes"){closeOnBodyClick=true;}else{closeOnBodyClick=false;}if(dialog_needIframe!="undefined"&&dialog_needIframe=="no"){needIframe=false;}else{needIframe=true;}if(!browser_opera){if(dialog_modal!="undefined"&&dialog_modal=="yes"){freezeBackground();}else{if(document.getElementById(FreezeLayer_VAR)!=null){document.body.removeChild(document.getElementById(FreezeLayer_VAR));}}}if(dialog_left!="undefined"){_11+=parseInt(dialog_left);}if(dialog_top!="undefined"){top+=parseInt(dialog_top);}var _18=(document.body.scrollLeft>0)?15:0;var _19=(document.body.scrollTop>0)?15:0;if(dialog_position!="undefined"&&dialog_position=="relative"){if(dialog_srcElement!="undefined"){srcEl=getObj(dialog_srcElement);}else{if(srcEl==null){srcEl=document.body;}}var _1a=(srcEl.offsetWidth)?srcEl.offsetWidth:0;var _1b=(srcEl.offsetHeight)?srcEl.offsetHeight:0;if(findPosX(srcEl)+_16>doc.width-_18){_11+=findPosX(srcEl)+_1a-_16;}else{_11+=findPosX(srcEl);}if(findPosY(srcEl)+_1b+_17>doc.height-_19){top+=findPosY(srcEl)-_17;}else{top+=findPosY(srcEl)+_1b+2;}}else{if(dialog_position!="undefined"&&dialog_position=="current"){if(dialog_cursor_left!=null&&dialog_cursor_top!=null){_11=dialog_cursor_left;top=dialog_cursor_top;}else{_11=top=0;}_11=(dialog_cursor_left!=null)?dialog_cursor_left:0;top=(dialog_cursor_top!=null)?dialog_cursor_top:0;if(_11+_16>doc.width-_18){_11-=_16;}if(top+_17>doc.height-_19){top-=_17;}}else{if(dialog_position!="undefined"&&dialog_position=="absolute"){_11+=document.body.scrollLeft;top+=document.body.scrollTop;}else{_11=(doc.width/2)-(_16/2)+document.body.scrollLeft;top=(doc.height/2)-(_17/2)+document.body.scrollTop;}}}_11=(_11>0)?_11:0;top=(top>0)?top:0;if(dialog_transitionType!="undefined"){if(dialog_transitionInterval=="undefined"){dialog_transitionInterval=10;}Effect.init({type:dialog_transitionType,speed:dialog_transitionInterval,layerId:_DIALOG_LAYER_VAR,layerTop:top,layerLeft:_11});Effect.display();}else{oDialog.style.left=parseInt(_11)+"px";oDialog.style.top=parseInt(top)+"px";}if(browser_ie&&!browser_opera&&needIframe==true){iframeIEHack=document.createElement("IFRAME");iframeIEHack.id=FreezeIFrame_VAR;iframeIEHack.scrolling="no";iframeIEHack.frameBorder=0;if(window["CONTEXT_PATH"]!=null){iframeIEHack.src=CONTEXT_PATH+"/framework/html/blank.html";}iframeIEHack.style.position="absolute";iframeIEHack.style.zIndex="98";iframeIEHack.style.filter="progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0)";if(dialog_modal!="undefined"&&dialog_modal=="yes"){iframeIEHack.style.width=document.getElementById(FreezeLayer_VAR).style.width;iframeIEHack.style.top="0px";iframeIEHack.style.left="0px";}else{iframeIEHack.style.width=oDialog.offsetWidth+"px";iframeIEHack.style.height=oDialog.offsetHeight+"px";iframeIEHack.style.top=parseInt(top)+"px";iframeIEHack.style.left=parseInt(_11)+"px";}document.body.appendChild(iframeIEHack);}var _1c=oDialog.getElementsByTagName("SCRIPT");for(var i=0;i<_1c.length;i++){var _1d=document.createElement("SCRIPT");_1d.type="text/javascript";_1d.language="javascript";if(_1c[i].src!=""){_1d.src=_1c[i].src;}_1d.text=_1c[i].text;if(typeof document.getElementsByTagName("HEAD")[0]=="undefined"){document.createElement("HEAD").appendChild(_1d);}else{document.getElementsByTagName("HEAD")[0].appendChild(_1d);}}if(_3!=null&&typeof _3!="undefined"){_3();}return oDialog;}var diffLeft=0,diffTop=0;function captureDialog(ev){if(oDialog!=null&&oDialog.id=="_DIALOG_LAYER_CHILD"&&oDialog.style.display=="none"){oDialog=document.getElementById("_DIALOG_LAYER");}oDialog.style.cursor="move";if(browser_ie){diffLeft=window.event.clientX+document.body.scrollLeft-parseInt(findPosX(oDialog));diffTop=window.event.clientY+document.body.scrollTop-parseInt(findPosY(oDialog));}else{if(browser_nn4||browser_nn6){diffLeft=ev.pageX-parseInt(findPosX(oDialog));diffTop=ev.pageY-parseInt(findPosY(oDialog));}}document.onmousemove=moveDialog;document.onmouseup=releaseDialog;}function moveDialog(ev){clearTextSelection();if(oDialog!=null&&oDialog.id=="_DIALOG_LAYER_CHILD"&&oDialog.style.display=="none"){oDialog=document.getElementById("_DIALOG_LAYER");}if(browser_ie){var _20=window.event.clientX+document.body.scrollLeft-diffLeft;var top=window.event.clientY+document.body.scrollTop-diffTop;_20=(_20>=0)?_20:0;top=(top>=0)?top:0;if(document.getElementById(FreezeLayer_VAR)!=null||browser_opera||iframeIEHack==null){oDialog.style.left=_20+"px";oDialog.style.top=top+"px";}else{oDialog.style.left=iframeIEHack.style.left=_20+"px";oDialog.style.top=iframeIEHack.style.top=top+"px";}}else{if(browser_nn4||browser_nn6){oDialog.style.left=((ev.pageX-diffLeft>0)?ev.pageX-diffLeft:0)+"px";oDialog.style.top=((ev.pageY-diffTop>0)?ev.pageY-diffTop:0)+"px";}}}function releaseDialog(){oDialog.style.cursor="default";document.onmousemove=null;document.onmouseup=null;}function closeDialog(_22){hideAllMenu();if(oDialog!=null&&oDialog.id=="_DIALOG_LAYER_CHILD"&&oDialog.style.display=="none"){oDialog=document.getElementById("_DIALOG_LAYER");}if(oDialog!=null&&oDialog.id=="_DIALOG_LAYER"&&oDialog.style.display!="none"){FreezeLayer_VAR="FreezeLayer";iframeIEHack=document.getElementById("FreezeIFrame");}if(oDialog!=null&&oDialog.style.display!="none"){oDialog.style.display="none";if(document.getElementById(FreezeLayer_VAR)!=null){document.getElementById(FreezeLayer_VAR).parentNode.removeChild(document.getElementById(FreezeLayer_VAR));}if(browser_ie&&!browser_opera&&iframeIEHack!=null){document.body.removeChild(iframeIEHack);}closeOnBodyClick=false;if(oCloseClBk&&oCloseClBk!=null&&oCloseClBk!="undefined"){oCloseClBk();}if(typeof _22!="undefined"&&_22.srcElement=="undefined"){_22();}}}function selElemData(_23){_23.select();}document.onkeydown=function(ev){if(browser_ie){var _25=window.event.keyCode;}else{if(browser_nn4||browser_nn6){var _25=ev.which;}}if(oDialog!=null&&oDialog.id=="_DIALOG_LAYER_CHILD"&&oDialog.style.display=="none"){oDialog=document.getElementById("_DIALOG_LAYER");FreezeLayer_VAR="FreezeLayer";}if(_25==27&&closeOnEscKey==true&&oDialog!=null&&oDialog.style.display!="none"){closeDialog();}};var dialog_cursor_left,dialog_cursor_top;document.onmousedown=function(ev){if(browser_ie){srcEl=window.event.srcElement;}else{if(browser_nn4||browser_nn6){srcEl=ev.target;}}var _27=getCursorPos(ev);var x=_27.x;var y=_27.y;dialog_cursor_left=x;dialog_cursor_top=y;if(typeof closeOnBodyClick!="undefined"&&closeOnBodyClick==true&&oDialog!=null&&oDialog.style.visibility!="hidden"){if((x<findPosX(oDialog)||x>=findPosX(oDialog)+oDialog.offsetWidth)||(y<findPosY(oDialog)||y>=findPosY(oDialog)+oDialog.offsetHeight)){var _2a=getScrollBarPos();var _2b=_2a.scrollX;var _2c=_2a.scrollY;if(x<_2b&&y<_2c){closeDialog();}}}};function getScrollBarPos(){var _2d=18;if(browser_ie){var x=document.body.offsetWidth+document.body.scrollLeft-_2d;var y=document.body.offsetHeight+document.body.scrollTop-_2d;}else{var x=window.innerWidth+window.pageXOffset-_2d;var y=window.innerHeight+window.pageYOffset-_2d;}return {scrollX:x,scrollY:y};}function getCursorPos(ev){if(browser_ie){var x=window.event.clientX+document.body.scrollLeft;var y=window.event.clientY+document.body.scrollTop;}else{if(browser_nn6){var x=ev.pageX;var y=ev.pageY;}}return {x:x,y:y};}var scrollEnd=0,cnt=0;function scrollPage(){if(cnt<=scrollEnd){document.body.scrollTop+=10;cnt+=10;}else{scrollEnd=cnt=0;clearInterval(scrollInterval);}}function showURLInDialog(url,_34,_35,_36){callBack=function(_37){var _38=showDialog(_37.responseText,_34,_35);if(_36){_38.setAttribute("opener",_36);}};AjaxAPI.sendRequest({METHOD:"GET",URL:url,ONSUCCESSFUNC:callBack});}function closeParentDialog(_39,_3a){closeDialog();if(_3a){var _3b=DOMUtils.getParentWithAttr(_39,"opener");AjaxAPI.refreshOpener({OPENER:_3b.getAttribute("opener")});}}function callDialog(_3c,_3d,_3e){var _3f="<div class='zc-dialogheader' elname='zc-dialogheader' onmousedown='captureDialog(event)'><table cellspacing='0' cellpadding='0' border='0'><tr><td class='zc-dialog-left'>";if(_3c&&_3c!=""){_3f=_3f+_3c+"</td>";}else{_3f=_3f+"&nbsp;</td>";}_3f=_3f+"<td class='zc-dialog-right' onclick='closeDialog();'>Close</td></tr></table></div><div class='zc-appformcontent' style='padding:2px;'><table border='0' cellpadding='0' cellspacing='0'><tr><td>";if(_3d&&_3d!=""){_3f=_3f+_3d+"</td></tr></table></div>";}else{_3f=_3f+"&nbsp;</td></tr></table></div>";}showDialog(_3f,_3e);}Effect=function(){};Effect.init=function(_40){if(typeof _40!="undefined"){this.type=(typeof _40.type!="undefined")?_40.type:"boxIn( { } )";this.speed=(typeof _40.speed!="undefined")?_40.speed:10;this.layer=document.getElementById(_40.layerId);this.layerId=_40.layerId;this.layerLeft=_40.layerLeft;this.layerTop=_40.layerTop;if(typeof _40.layerContent=="undefined"||_40.layerContent==null||_40.layerContent==""){this.layerContent=this.layer.innerHTML;}else{this.layerContent=_40.layerContent;}if(typeof _40.layerWidth=="undefined"||_40.layerWidth==null||_40.layerWidth==""){this.layerWidth=this.layer.offsetWidth;}else{this.layerWidth=_40.layerWidth;}if(typeof _40.layerHeight=="undefined"||_40.layerHeight==null||_40.layerHeight==""){this.layerHeight=this.layer.offsetHeight;}else{this.layerHeight=_40.layerHeight;}}else{this.speed=10;}};var xPoint,yPoint;Effect.drawPath=function(x1,y1,x2,y2){xPoint=new Array();yPoint=new Array();var _45=Math.sqrt((x2-x1)*(x2-x1)+(y2-y1)*(y2-y1));var dx=(x2-x1)/_45;var dy=(y2-y1)/_45;for(var i=0;i<_45;i++){xPoint[i]=x1+=dx;yPoint[i]=y1+=dy;}};var wArray,hArray;Effect.buildSize=function(){wArray=new Array();hArray=new Array();var _49=this.layerHeight/this.layerWidth;for(var i=0,j=0;i<=this.layerWidth;i+=1,j++){wArray[j]=i;hArray[j]=i*_49;}};var pitStops=0,dim=0,movCnt=0,dimCnt=0,effectIntvl;Effect.display=function(){var _4c=this.layerLeft+parseInt(this.layerWidth/2);var _4d=this.layerTop+parseInt(this.layerHeight/2);this.layer.style.left=_4c+"px";this.layer.style.top=_4d+"px";this.layer.style.width=this.layer.style.height="0px";this.layer.style.overflow="hidden";this.drawPath(this.layerLeft,this.layerTop,_4c,_4d);movCnt=xPoint.length-1;pitStops=(xPoint.length>5)?(xPoint.length-1)/5:1;this.buildSize();dim=wArray.length/(movCnt/pitStops);effectIntvl=setInterval(eval("this."+this.type),this.speed);};Effect.boxIn=function(){if(movCnt>0){Effect.layer.style.left=xPoint[movCnt]+"px";Effect.layer.style.top=yPoint[movCnt]+"px";if(wArray[dimCnt]){Effect.layer.style.width=wArray[dimCnt]+"px";Effect.layer.style.height=hArray[dimCnt]+"px";}movCnt-=Math.round(pitStops);dimCnt+=Math.round(dim);}else{Effect.layer.style.left=Effect.layerLeft+"px";Effect.layer.style.top=Effect.layerTop+"px";Effect.layer.style.width=Effect.layerWidth+"px";Effect.layer.style.height=Effect.layerHeight+"px";Effect.layer.style.overflow="";pitStops=dim=movCnt=dimCnt=0;window.clearInterval(effectIntvl);}};var rq=new Array();var paramsArr=new Array();function importxml(url,f,_50,_51,_52,_53,_54){return handleRequest(url,f,_50,_51,null,_52,_53,_54);}function importxmlForForm(_55,f,_57,_58,_59){if(!_57){_57="";}return handleRequest(_55.action,f,_57,_58,_55,_59);}var lockstate=false;var errorUrl="/";function handleRequest(u,f,_5c,_5d,_5e,_5f,_60,_61){if(lockstate==true){return;}if(_5f){lockstate=true;}try{if(errUrl!=null&&typeof errUrl!="undefined"){errorUrl=errUrl;}}catch(e1){}if(_5d!=false&&_5d!="false"){loadon(_5d);}try{if(_5e&&_5e!=null&&(_5e.method).toLowerCase()=="post"&&csrfParamName&&csrfParamName!=null&&csrfToken&&csrfToken!=null){var _62=document.createElement("input");_62.name=csrfParamName;_62.type="hidden";_62.value=csrfToken;_5e.appendChild(_62);}else{if((csrfParamName&&csrfParamName!=null&&csrfToken&&csrfToken!=null)&&_60){if(typeof (_61)!="undefined"){_61+="&";}else{_61="";}_61+=csrfParamName+"="+csrfToken;}}if(appid!=null&&sharedBy!=null&&typeof appid!="undefined"&&typeof sharedBy!="undefined"){u+=((u.indexOf("?")+1)?"&":"?")+"&zohoaccess-appid="+appid+"&sharedBy="+sharedBy;}if(runtime==false){u+=((u.indexOf("?")+1)?"&":"?")+"zohoruntime="+(new Date()).getTime();}}catch(e){}if(window.XMLHttpRequest){var _63=getXmlObj();rt=rq.length;rq[rt]=_63;var _64=paramsArr.length;paramsArr[_64]=_5c;rq[rt].onreadystatechange=new Function("if( rq["+rt+"].readyState == 4) { if(rq["+rt+"].status < 300 ) { loadoff();lockstate=false;"+f+"(rq["+rt+"].responseXML, paramsArr["+_64+"]); } else {showRedirect(rq["+rt+"].status,rq["+rt+"].statusText,errorUrl);}}");if(_5e&&_5e!=null){handleForm(rq[rt],u,_5e);}else{if(_60){rq[rt].open("POST",u,true);rq[rt].setRequestHeader("Content-type","application/x-www-form-urlencoded;charset=UTF-8");if(typeof (_61)!="undefined"){rq[rt].setRequestHeader("Content-length",_61.length);rq[rt].send(_61);}}else{rq[rt].open("GET",u,true);rq[rt].send(null);}}return rq[rt];}if(!navigator.__ice_version&&window.ActiveXObject){try{var _63=getXmlObj(_5e);rt=rq.length;rq[rt]=_63;var _64=paramsArr.length;paramsArr[_64]=_5c;rq[rt].onreadystatechange=new Function("if( rq["+rt+"].readyState == 4) { var toSend = rq["+rt+"]; if(rq["+rt+"].responseXML) {toSend = rq["+rt+"].responseXML} if(rq["+rt+"].status >= 300){showRedirect(rq["+rt+"].status, rq["+rt+"].statusText,errorUrl);} else { loadoff();lockstate=false;"+f+"(toSend, paramsArr["+_64+"]); }}");if(_5e&&_5e!=null){handleForm(rq[rt],u,_5e);}else{rq[rt].load(u);}return true;}catch(e){alert(e);}}return false;}function handleForm(req,u,_67,_68){var nvp=getFormQS(_67);if(_68){req.open("POST",u,true);}else{req.open("POST",u,true);}req.setRequestHeader("Content-type","application/x-www-form-urlencoded;charset=UTF-8");req.setRequestHeader("Content-length",nvp.length);req.send(nvp);}function getFormQS(frm){var qs="";for(var c=0;c<frm.elements.length;c++){if(document.all){var el=frm.elements[c];}else{var el=frm.elements.item(c);}if(el.nodeName!="FIELDSET"){switch(el.type){case "textarea":case "hidden":case "text":qs+=el.name+"="+encodeURIComponent(el.value)+"&";break;case "select-one":if(el.selectedIndex!=-1){sv=el.options[el.selectedIndex].value;qs+=el.name+"="+encodeURIComponent(sv)+"&";}break;case "select-multiple":ss="";for(var so=0;so<el.options.length;so++){if(el.options[so].selected==true){ss+=(ss=="")?"":"&";sv=el.options[so].value;ss+=el.name+"="+encodeURIComponent(sv);}}ss+=(ss=="")?"":"&";qs+=ss;break;case "radio":case "checkbox":if(el.checked==true){qs+=el.name+"="+encodeURIComponent(el.value)+"&";}break;default:qs+=el.name+"="+encodeURIComponent(el.value)+"&";}}}qs=qs.substr(0,(qs.length-1));return qs;}function loadoff(){var _6f=document.getElementById("loading");if(_6f){_6f.style.display="none";}}function loadon(_70){var _71=document.getElementById("loading");var _72=document.getElementById("loadingmsg");if(_71&&_72){if(_70){_72.innerHTML=_70;}else{_72.innerHTML=i18Arr["hrms.general.pleasewaitmsg"]+"...";}var dim=findDocDim();_71.style.display="block";_71.style.left=dim.width/2-_71.offsetWidth/2;_71.style.top=dim.height/2-_71.offsetHeight/2;}}function getXmlObj(_74){var _75=null;if(document.all){var _75=null;if(window.XMLHttpRequest){_75=new XMLHttpRequest();}else{if(!_74){try{_75=new ActiveXObject("Microsoft.XMLDOM");}catch(e){}}if(_75==null){try{_75=new ActiveXObject("Msxml2.XMLHTTP");}catch(e){}}if(_75==null){try{_75=new ActiveXObject("Microsoft.XMLHTTP");}catch(e){throw new Exception(i18n.browsernotsupported);}}}}else{_75=new XMLHttpRequest();}return _75;}function getHtmlForFormOnChange(_76,f,_78,_79){if(!_78){_78="";}return getHtml(_76.action,f,_78,status,_76,_79,true);}function getHtmlForForm(_7a,f,_7c,_7d,_7e){if(!_7c){_7c="";}return getHtml(_7a.action,f,_7c,_7d,_7a,_7e);}function getHtml(url,fn,_81,_82,_83,_84,_85,_86,_87){if(lockstate==true){return;}if(_84){lockstate=true;}if(_82!=false&&_82!="false"){loadon(_82);}try{if(errUrl!=null&&typeof errUrl!="undefined"){errorUrl=errUrl;}}catch(e1){}if(_82!=false&&_82!="false"){loadon(_82);}var _88=null;if(window.XMLHttpRequest){_88=getXmlObj(true);}else{if(!navigator.__ice_version&&window.ActiveXObject){_88=getXmlObj(true);}else{return false;}}try{if(_83&&_83!=null&&(_83.method).toLowerCase()=="post"&&csrfParamName&&csrfParamName!=null&&csrfToken&&csrfToken!=null){var _89=document.createElement("input");_89.name=csrfParamName;_89.type="hidden";_89.value=csrfToken;_83.appendChild(_89);}else{if((csrfParamName&&csrfParamName!=null&&csrfToken&&csrfToken!=null)&&_86){if(typeof (_87)!="undefined"){_87+="&";}else{_87="";}_87+=csrfParamName+"="+csrfToken;}}if(runtime==false){url+=((url.indexOf("?")+1)?"&":"?")+"&zohoruntime="+(new Date()).getTime();}}catch(e){}rt=rq.length;rq[rt]=_88;var _8a=paramsArr.length;paramsArr[_8a]=_81;if(_88){rq[rt].onreadystatechange=new Function(" if (rq["+rt+"].readyState==4) { /*if(rq["+rt+"].status < 300) {*/loadoff();lockstate=false;"+fn+"(rq["+rt+"].responseText, paramsArr["+_8a+"]); /* } else {showRedirect(rq["+rt+"].status,rq["+rt+"].statusText,errorUrl);}*/}");if(_83&&_83!=null){handleForm(rq[rt],url,_83,_85);}else{if(_86){rq[rt].open("POST",url,true);rq[rt].setRequestHeader("Content-type","application/x-www-form-urlencoded;charset=UTF-8");if(typeof (_87)!="undefined"){rq[rt].setRequestHeader("Content-length",_87.length);rq[rt].send(_87);}}else{rq[rt].open("GET",url,true);rq[rt].setRequestHeader("Content-type","text/html");rq[rt].setRequestHeader("Content-length",0);rq[rt].send(null);}}}return true;}function showRedirect(_8b,_8c,_8d){if(_8b==500){alert(i18Arr["hrms.general.erralert1msg"]+"\n"+i18Arr["hrms.general.erralert2msg"]);loadoff();return;}alert(_8b+" : "+_8c);location.href=_8d;}function lazyloadjs(f){if(f&&f.length>0){getHtml(f[0],"evalLazyload",f,false);}}function evalLazyload(txt,f){if(window.execScript){window.execScript(txt);}else{window.eval(txt);}f.splice(0,1);if(f.length>0){getHtml(f[0],"evalLazyload",f,false);}}function lazyloadcss(f){for(var i=0;i<f.length;i++){if(document.createStyleSheet){document.createStyleSheet(f[i]);}else{var c=document.createElement("link");c.rel="stylesheet";c.href=f[i];c.type="text/css";document.getElementsByTagName("head")[0].appendChild(c);}}}function executescript(_94,_95,_96){if(!_94||!_95){return;}var ss=_94.getElementsByTagName("script");for(var i=0;i<ss.length;i++){var _99=ss.item(i);if(_99){var id=_99.id;if((id&&((id.indexOf("scriptcalid")!=-1)||(id.indexOf("SHEETSCRIPT")!=-1)||(id.indexOf("VIEWARRSCRIPT")!=-1)||(id.indexOf("SHEETCOG")!=-1)||(id.indexOf("CAPTCHASCRIPT")!=-1)))||_96){var txt=_99.innerHTML;if(window.execScript){window.execScript(txt);}else{window.eval(txt);}}}}}function getRespArr(_9c){var _9d=eval(_9c);var _9e=new Array();for(var i in _9d){var _a0=_9d[i];for(var j in _a0){_9e[j]=_a0[j];}}return _9e;}(function($){var _a3=function(){var ids={},_a5,_a6=65,_a7,tpl="<div class=\"colorpicker\"><div class=\"colorpicker_color\"><div><div></div></div></div><div class=\"colorpicker_hue\"><div></div></div><div class=\"colorpicker_new_color\"></div><div class=\"colorpicker_current_color\"></div><div class=\"colorpicker_hex\"><input type=\"text\" maxlength=\"6\" size=\"6\" /></div><div class=\"colorpicker_rgb_r colorpicker_field\"><input type=\"text\" maxlength=\"3\" size=\"3\" /><span></span></div><div class=\"colorpicker_rgb_g colorpicker_field\"><input type=\"text\" maxlength=\"3\" size=\"3\" /><span></span></div><div class=\"colorpicker_rgb_b colorpicker_field\"><input type=\"text\" maxlength=\"3\" size=\"3\" /><span></span></div><div class=\"colorpicker_hsb_h colorpicker_field\"><input type=\"text\" maxlength=\"3\" size=\"3\" /><span></span></div><div class=\"colorpicker_hsb_s colorpicker_field\"><input type=\"text\" maxlength=\"3\" size=\"3\" /><span></span></div><div class=\"colorpicker_hsb_b colorpicker_field\"><input type=\"text\" maxlength=\"3\" size=\"3\" /><span></span></div><div class=\"colorpicker_submit\"></div></div>",_a9={eventName:"click",onShow:function(){},onBeforeShow:function(){},onHide:function(){},onChange:function(){},onSubmit:function(){},color:"ff0000",livePreview:true,flat:false},_aa=function(hsb,cal){var rgb=_ae(hsb);$(cal).data("colorpicker").fields.eq(1).val(rgb.r).end().eq(2).val(rgb.g).end().eq(3).val(rgb.b).end();},_af=function(hsb,cal){$(cal).data("colorpicker").fields.eq(4).val(hsb.h).end().eq(5).val(hsb.s).end().eq(6).val(hsb.b).end();},_b2=function(hsb,cal){$(cal).data("colorpicker").fields.eq(0).val(_b5(hsb)).end();},_b6=function(hsb,cal){$(cal).data("colorpicker").selector.css("backgroundColor","#"+_b5({h:hsb.h,s:100,b:100}));$(cal).data("colorpicker").selectorIndic.css({left:parseInt(150*hsb.s/100,10),top:parseInt(150*(100-hsb.b)/100,10)});},_b9=function(hsb,cal){$(cal).data("colorpicker").hue.css("top",parseInt(150-150*hsb.h/360,10));},_bc=function(hsb,cal){$(cal).data("colorpicker").currentColor.css("backgroundColor","#"+_b5(hsb));},_bf=function(hsb,cal){$(cal).data("colorpicker").newColor.css("backgroundColor","#"+_b5(hsb));},_c2=function(ev){var _c4=ev.charCode||ev.keyCode||-1;if((_c4>_a6&&_c4<=90)||_c4==32){return false;}var cal=$(this).parent().parent();if(cal.data("colorpicker").livePreview===true){_c6.apply(this);}},_c6=function(ev){var cal=$(this).parent().parent(),col;if(this.parentNode.className.indexOf("_hex")>0){cal.data("colorpicker").color=col=_ca(_cb(this.value));}else{if(this.parentNode.className.indexOf("_hsb")>0){cal.data("colorpicker").color=col=_cc({h:parseInt(cal.data("colorpicker").fields.eq(4).val(),10),s:parseInt(cal.data("colorpicker").fields.eq(5).val(),10),b:parseInt(cal.data("colorpicker").fields.eq(6).val(),10)});}else{cal.data("colorpicker").color=col=_cd(_ce({r:parseInt(cal.data("colorpicker").fields.eq(1).val(),10),g:parseInt(cal.data("colorpicker").fields.eq(2).val(),10),b:parseInt(cal.data("colorpicker").fields.eq(3).val(),10)}));}}if(ev){_aa(col,cal.get(0));_b2(col,cal.get(0));_af(col,cal.get(0));}_b6(col,cal.get(0));_b9(col,cal.get(0));_bf(col,cal.get(0));cal.data("colorpicker").onChange.apply(cal,[col,_b5(col),_ae(col)]);},_cf=function(ev){var cal=$(this).parent().parent();cal.data("colorpicker").fields.parent().removeClass("colorpicker_focus");},_d2=function(){_a6=this.parentNode.className.indexOf("_hex")>0?70:65;$(this).parent().parent().data("colorpicker").fields.parent().removeClass("colorpicker_focus");$(this).parent().addClass("colorpicker_focus");},_d3=function(ev){var _d5=$(this).parent().find("input").focus();var _d6={el:$(this).parent().addClass("colorpicker_slider"),max:this.parentNode.className.indexOf("_hsb_h")>0?360:(this.parentNode.className.indexOf("_hsb")>0?100:255),y:ev.pageY,field:_d5,val:parseInt(_d5.val(),10),preview:$(this).parent().parent().data("colorpicker").livePreview};$(document).bind("mouseup",_d6,_d7);$(document).bind("mousemove",_d6,_d8);},_d8=function(ev){ev.data.field.val(Math.max(0,Math.min(ev.data.max,parseInt(ev.data.val+ev.pageY-ev.data.y,10))));if(ev.data.preview){_c6.apply(ev.data.field.get(0),[true]);}return false;},_d7=function(ev){_c6.apply(ev.data.field.get(0),[true]);ev.data.el.removeClass("colorpicker_slider").find("input").focus();$(document).unbind("mouseup",_d7);$(document).unbind("mousemove",_d8);return false;},_db=function(ev){var _dd={cal:$(this).parent(),y:$(this).offset().top};_dd.preview=_dd.cal.data("colorpicker").livePreview;$(document).bind("mouseup",_dd,_de);$(document).bind("mousemove",_dd,_df);},_df=function(ev){_c6.apply(ev.data.cal.data("colorpicker").fields.eq(4).val(parseInt(360*(150-Math.max(0,Math.min(150,(ev.pageY-ev.data.y))))/150,10)).get(0),[ev.data.preview]);return false;},_de=function(ev){_aa(ev.data.cal.data("colorpicker").color,ev.data.cal.get(0));_b2(ev.data.cal.data("colorpicker").color,ev.data.cal.get(0));$(document).unbind("mouseup",_de);$(document).unbind("mousemove",_df);return false;},_e2=function(ev){var _e4={cal:$(this).parent(),pos:$(this).offset()};_e4.preview=_e4.cal.data("colorpicker").livePreview;$(document).bind("mouseup",_e4,_e5);$(document).bind("mousemove",_e4,_e6);},_e6=function(ev){_c6.apply(ev.data.cal.data("colorpicker").fields.eq(6).val(parseInt(100*(150-Math.max(0,Math.min(150,(ev.pageY-ev.data.pos.top))))/150,10)).end().eq(5).val(parseInt(100*(Math.max(0,Math.min(150,(ev.pageX-ev.data.pos.left))))/150,10)).get(0),[ev.data.preview]);return false;},_e5=function(ev){_aa(ev.data.cal.data("colorpicker").color,ev.data.cal.get(0));_b2(ev.data.cal.data("colorpicker").color,ev.data.cal.get(0));$(document).unbind("mouseup",_e5);$(document).unbind("mousemove",_e6);return false;},_e9=function(ev){$(this).addClass("colorpicker_focus");},_eb=function(ev){$(this).removeClass("colorpicker_focus");},_ed=function(ev){var cal=$(this).parent();var col=cal.data("colorpicker").color;cal.data("colorpicker").origColor=col;_bc(col,cal.get(0));cal.data("colorpicker").onSubmit(col,_b5(col),_ae(col),cal.data("colorpicker").el);},_f1=function(ev){var cal=$("#"+$(this).data("colorpickerId"));cal.data("colorpicker").onBeforeShow.apply(this,[cal.get(0)]);var pos=$(this).offset();var _f5=_f6();var top=pos.top+this.offsetHeight;var _f8=pos.left;if(top+176>_f5.t+_f5.h){top-=this.offsetHeight+176;}if(_f8+356>_f5.l+_f5.w){_f8-=356;}cal.css({left:_f8+"px",top:top+"px"});if(cal.data("colorpicker").onShow.apply(this,[cal.get(0)])!=false){cal.show();}$(document).bind("mousedown",{cal:cal},_f9);return false;},_f9=function(ev){if(!_fb(ev.data.cal.get(0),ev.target,ev.data.cal.get(0))){if(ev.data.cal.data("colorpicker").onHide.apply(this,[ev.data.cal.get(0)])!=false){ev.data.cal.hide();}$(document).unbind("mousedown",_f9);}},_fb=function(_fc,el,_fe){if(_fc==el){return true;}if(_fc.contains){return _fc.contains(el);}if(_fc.compareDocumentPosition){return !!(_fc.compareDocumentPosition(el)&16);}var _ff=el.parentNode;while(_ff&&_ff!=_fe){if(_ff==_fc){return true;}_ff=_ff.parentNode;}return false;},_f6=function(){var m=document.compatMode=="CSS1Compat";return {l:window.pageXOffset||(m?document.documentElement.scrollLeft:document.body.scrollLeft),t:window.pageYOffset||(m?document.documentElement.scrollTop:document.body.scrollTop),w:window.innerWidth||(m?document.documentElement.clientWidth:document.body.clientWidth),h:window.innerHeight||(m?document.documentElement.clientHeight:document.body.clientHeight)};},_cc=function(hsb){return {h:Math.min(360,Math.max(0,hsb.h)),s:Math.min(100,Math.max(0,hsb.s)),b:Math.min(100,Math.max(0,hsb.b))};},_ce=function(rgb){return {r:Math.min(255,Math.max(0,rgb.r)),g:Math.min(255,Math.max(0,rgb.g)),b:Math.min(255,Math.max(0,rgb.b))};},_cb=function(hex){var len=6-hex.length;if(len>0){var o=[];for(var i=0;i<len;i++){o.push("0");}o.push(hex);hex=o.join("");}return hex;},_107=function(hex){var hex=parseInt(((hex.indexOf("#")>-1)?hex.substring(1):hex),16);return {r:hex>>16,g:(hex&65280)>>8,b:(hex&255)};},_ca=function(hex){return _cd(_107(hex));},_cd=function(rgb){var hsb={h:0,s:0,b:0};var min=Math.min(rgb.r,rgb.g,rgb.b);var max=Math.max(rgb.r,rgb.g,rgb.b);var _10e=max-min;hsb.b=max;if(max!=0){}hsb.s=max!=0?255*_10e/max:0;if(hsb.s!=0){if(rgb.r==max){hsb.h=(rgb.g-rgb.b)/_10e;}else{if(rgb.g==max){hsb.h=2+(rgb.b-rgb.r)/_10e;}else{hsb.h=4+(rgb.r-rgb.g)/_10e;}}}else{hsb.h=-1;}hsb.h*=60;if(hsb.h<0){hsb.h+=360;}hsb.s*=100/255;hsb.b*=100/255;return hsb;},_ae=function(hsb){var rgb={};var h=Math.round(hsb.h);var s=Math.round(hsb.s*255/100);var v=Math.round(hsb.b*255/100);if(s==0){rgb.r=rgb.g=rgb.b=v;}else{var t1=v;var t2=(255-s)*v/255;var t3=(t1-t2)*(h%60)/60;if(h==360){h=0;}if(h<60){rgb.r=t1;rgb.b=t2;rgb.g=t2+t3;}else{if(h<120){rgb.g=t1;rgb.b=t2;rgb.r=t1-t3;}else{if(h<180){rgb.g=t1;rgb.r=t2;rgb.b=t2+t3;}else{if(h<240){rgb.b=t1;rgb.r=t2;rgb.g=t1-t3;}else{if(h<300){rgb.b=t1;rgb.g=t2;rgb.r=t2+t3;}else{if(h<360){rgb.r=t1;rgb.g=t2;rgb.b=t1-t3;}else{rgb.r=0;rgb.g=0;rgb.b=0;}}}}}}}return {r:Math.round(rgb.r),g:Math.round(rgb.g),b:Math.round(rgb.b)};},_117=function(rgb){var hex=[rgb.r.toString(16),rgb.g.toString(16),rgb.b.toString(16)];$.each(hex,function(nr,val){if(val.length==1){hex[nr]="0"+val;}});return hex.join("");},_b5=function(hsb){return _117(_ae(hsb));},_11d=function(){var cal=$(this).parent();var col=cal.data("colorpicker").origColor;cal.data("colorpicker").color=col;_aa(col,cal.get(0));_b2(col,cal.get(0));_af(col,cal.get(0));_b6(col,cal.get(0));_b9(col,cal.get(0));_bf(col,cal.get(0));};return {init:function(opt){opt=$.extend({},_a9,opt||{});if(typeof opt.color=="string"){opt.color=_ca(opt.color);}else{if(opt.color.r!=undefined&&opt.color.g!=undefined&&opt.color.b!=undefined){opt.color=_cd(opt.color);}else{if(opt.color.h!=undefined&&opt.color.s!=undefined&&opt.color.b!=undefined){opt.color=_cc(opt.color);}else{return this;}}}return this.each(function(){if(!$(this).data("colorpickerId")){var _121=$.extend({},opt);_121.origColor=opt.color;var id="collorpicker_"+parseInt(Math.random()*1000);$(this).data("colorpickerId",id);var cal=$(tpl).attr("id",id);if(_121.flat){cal.appendTo(this).show();}else{cal.appendTo(document.body);}_121.fields=cal.find("input").bind("keyup",_c2).bind("change",_c6).bind("blur",_cf).bind("focus",_d2);cal.find("span").bind("mousedown",_d3).end().find(">div.colorpicker_current_color").bind("click",_11d);_121.selector=cal.find("div.colorpicker_color").bind("mousedown",_e2);_121.selectorIndic=_121.selector.find("div div");_121.el=this;_121.hue=cal.find("div.colorpicker_hue div");cal.find("div.colorpicker_hue").bind("mousedown",_db);_121.newColor=cal.find("div.colorpicker_new_color");_121.currentColor=cal.find("div.colorpicker_current_color");cal.data("colorpicker",_121);cal.find("div.colorpicker_submit").bind("mouseenter",_e9).bind("mouseleave",_eb).bind("click",_ed);_aa(_121.color,cal.get(0));_af(_121.color,cal.get(0));_b2(_121.color,cal.get(0));_b9(_121.color,cal.get(0));_b6(_121.color,cal.get(0));_bc(_121.color,cal.get(0));_bf(_121.color,cal.get(0));if(_121.flat){cal.css({position:"relative",display:"block"});}else{$(this).bind(_121.eventName,_f1);}}});},showPicker:function(){return this.each(function(){if($(this).data("colorpickerId")){_f1.apply(this);}});},hidePicker:function(){return this.each(function(){if($(this).data("colorpickerId")){$("#"+$(this).data("colorpickerId")).hide();}});},setColor:function(col){if(typeof col=="string"){col=_ca(col);}else{if(col.r!=undefined&&col.g!=undefined&&col.b!=undefined){col=_cd(col);}else{if(col.h!=undefined&&col.s!=undefined&&col.b!=undefined){col=_cc(col);}else{return this;}}}return this.each(function(){if($(this).data("colorpickerId")){var cal=$("#"+$(this).data("colorpickerId"));cal.data("colorpicker").color=col;cal.data("colorpicker").origColor=col;_aa(col,cal.get(0));_af(col,cal.get(0));_b2(col,cal.get(0));_b9(col,cal.get(0));_b6(col,cal.get(0));_bc(col,cal.get(0));_bf(col,cal.get(0));}});}};}();$.fn.extend({ColorPicker:_a3.init,ColorPickerHide:_a3.hidePicker,ColorPickerShow:_a3.showPicker,ColorPickerSetColor:_a3.setColor});})(jQuery);